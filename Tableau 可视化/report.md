# Tableau故事可视化
## Rossmann Store Sales Prediction

Seven He 
2018年10月21日




## I. 总结

影响销量的特征主要包括时间序列、商店分类、促销、竞争、节假日、地理位置等。通过分析销量月走势与周走势，可以看出销量具有很强的时间周期性。另外在特征分析中发现StoreType b、12月和周日具有明显的个体特征。从采样、促销、竞争、节假日、地理位置中也挖掘出了不少规律（详见后续分析）。




## II. 设计
#### 1. 销量、人均销量、商店中值销量直方分布

##### 最初设计

首先分析目标本身，销量以及其衍生特征，具体包括：

- 日销量直方分布
- 人均销量直方分布
- 按商店分组后的中值销量直方分布

图表类型为三个直方图，可视化编码为直方图的面积和形状分布



##### 反馈修改

建议添加文字描述，解释可视化分析出的一些规律。



##### 结论

- 三个直方分布都基本符合正态分布
- 存在高频低量的用户群，推测为附近居民用于日常消费
- 存在少量大型商店或明星商店，造成分布左偏态的原因





#### 2. 销量与顾客数散点图-相关性分析

##### 最初设计

通过散点图展示销量与顾客数之间的关系，并做拟合分析。

图表类型为散点图，可视化编码包括散点图点的位置分布以及红色的趋势线。



##### 反馈修改

建议添加文字描述，解释可视化分析出的一些规律。



##### 结论

销量与顾客数具有很强的正相关性，建议在特征工程中加入人均销量的聚合分析。





#### 3. 商店类别StoreType相关分析

##### 最初设计

商店类别StoreType相关分析，包括：

- 填充气泡图展示StoreType分布比例
- 各个商店类别的整体时间趋势
- 小多组图展示每个商店类型的直方分布

图表类型包括填充气泡图，线（连续）图，小多组直方图，可视化编码包括颜色，大小，线的趋势，面积及形状分布。

图例为四种StoreType，深蓝色为a，浅蓝色为b，深橘色为c，浅橘色为d。



##### 反馈修改

建议添加文字描述，解释可视化分析出的一些规律。



##### 结论

b类型与其他类型存在明显的差异，建议额外单独建模融合。





#### 4. StoreType-促销-DOW-月销量多特征走势分析

##### 最初设计

综合StoreStype，DayOfWeek，Promo，Month特征进行销量走势分析。

图表类型包括线（连续）小多组图，面积小多组图（连续），可视化编码包括颜色，线的趋势，面积及形状分布。

图例为是否促销，黄色空心方块代表促销，蓝色空心圆代表不促销。



##### 反馈修改

- 建议添加文字描述，解释可视化分析出的一些规律。
- 颜色图例和形状图例合并。
- DayOfWeek 1-7用具体的星期名称别名表示。



##### 结论

- 商店类型：acd走势类似，b有明显的区别
- 促销：促销对销量有积极促进作用，周末不选择促销
- DOW周日：b类周日销量更高，ad周日销量更低，且幅度较大，c类周日不营业
- 月销量走势：整体走势相似，12月销量最高，推测是圣诞新年促销导致的，89月销量是全年低谷





#### 5. 竞争对手距离对销量的影响

##### 最初设计

竞争对手距离的对数与按Store分组的销量中值对数的散点图分析。

图表类型为散点图，可视化编码包括散点图点的位置分布以及灰色的中位线，红色的趋势线。



##### 反馈修改

建议添加文字描述，解释可视化分析出的一些规律。



##### 结论

- 分布：销量中位数为6181，距离中位数为2425，大部分竞争对手的距离分布在1000-10000之间
- 竞争对手距离对于销量有较小的影响，当距离较小时中值销量最大，可以推测这是因为距离较小意味着一般是繁华的市区，导致附近的商店定价和销量比较高，或者可以理解成竞争压力导致的正面效应。



#### 6. 关键特征热图分析

##### 最初设计

通过热图综合分析关键特征，包括Sales，StoreType， DayOfWeek，Promo，Month，Holiday。

图表类型为热图，可视化编码包括颜色、形状和宽度。

图例为是否促销，黄色实心方块代表促销，蓝色实心方块代表不促销。



##### 反馈修改

- 建议添加文字描述，解释可视化分析出的一些规律。
- 用星期和月份缩写来替代数字，增强可读性。
- 热图纵向分割与横向分割的区别（已修改为条形）



##### 结论

从中可以挖掘出很多规律，如：

- 商店类别：b类整体销量最高，c类周日不营业，ad类周日销量远比平时低，b类比平时高，d类11月周日不营业。
- 促销规律：周末从不促销，11月份节假日几乎都在促销，而12月份节假日几乎不促销。
- 促销效果：同期促销比不促销的销量更高，也有某些时段促销效果大体上并不理想，如周五和六七月。
- 月销量：12月为全年最高，推测是圣诞新年促销导致的，89月销量是全年低谷。



#### 7. 采样商店关键指标分析

##### 最初设计

从1115个商店中采样了4个具有代表性的商店(a：238，b：512，c：897，d：94)，并分析其关键指标，包括销量箱线图，日销量时间整体分布，月销量走势，周销量走势。

抽样分析肯定是有必要的，因为在探索时间序列规律时，基于总体或聚类分析反映的是整体走势，而无法探究个体的时间走势。而且同时我们也是为了探索Store这个特征对销量的影响，通过分析也可以发现Store是相关性非常强的特征。

图表类型包括箱线图，小多组散点图，线（连续）图，可视化编码包括颜色，点的位置，箱线，形状，线的走势。

图例为四个采样商店，蓝色空心圆代表94号商店，黄色叉代表238号商店，红色空心方块代表512号商店，绿色空心三角形代表897号商店。



##### 反馈修改

- 建议添加文字描述，解释可视化分析出的一些规律。
- 颜色图例和形状图例合并。
- 由于距离过窄，只显示出一个时间。



##### 结论

- 每个商店都有一定的上界离群值，推测是由节日和促销带来的较高的峰值销量。
- 不同Store的整体月走势是相似的，细节上存在个体特征差异，基于Store的特征聚合是必要的。





#### 8. 商店的行政归属与地理位置分布

##### 最初设计

通过Google Places API提取的Rossmann商店地理分布和行政归属，信息包括经纬度，所属州，最近酒店和火车站距离，所属城市及人口，营业时间等。

图表类型包括地图，可视化编码包括颜色，形状，大小，点的位置。

图例中不同颜色代表了不同的州，大小代表了每周总营业小时数，形状代表了周日是否营业，叉为营业，圆为不营业，还有四个筛选器，分别是开业时间，最近的火车站距离，最近的旅店距离以及海拔。



##### 反馈修改

- 加入营业信息，联接rossmann_opening_hours.csv。
- 建议添加文字描述，解释可视化分析出的一些规律。
- 优化图例。



##### 结论

从中可以挖掘出很多规律，如：

- 大部分商店周日不营业
- 营业时间大多分布在60-72小时
- 商店数量分布最多的是NW(North Rhine-Westphalia)，商店分布密度最高的是BE（德国首都Berlin）





## III. 反馈

已修改的反馈：

- 建议添加文字描述，解释可视化分析出的一些规律。
- 颜色图例和形状图例合并。
- DayOfWeek 1-7用具体的星期名称别名表示。
- 默认“Sunday 内/外”含义表示不清晰，改为是否。
- 用星期和月份缩写来替代数字，增强可读性。
- 加入营业信息，联接rossmann_opening_hours.csv。
- 优化地理位置DashBoard的图例。
- 由于距离过窄，只显示出一个时间。
- 热图纵向分割与横向分割的区别（已修改为条形）。



其他反馈：

- 为何未分析Assortment？（因为Assortment与StoreType非常类似，本项目主要是为了展示tableau各种可视化功能，回避了相似的可视化分析。）




## IV. 资源

原始数据集来自https://www.kaggle.com/c/rossmann-store-sales/data，已做部分数据清洗和特征工程

某些图的灵感来自https://www.kaggle.com/thie1e/exploratory-analysis-rossmann

地理信息外部数据集来自https://www.kaggle.com/c/rossmann-store-sales/discussion/17048